## Instructions

**Remove header from h1b data**

**Data Description: h1b data with ascii null "\0" as delimiter is available in HDFS**

### h1b data information:

> **\*HDFS location:** /public/h1b/h1b_data  
> First record is the header for the data\*

### Output Requirements

> **Remove the header from the data and save rest of the data as is  
> Data should be compressed using snappy algorithm  
> Place the H1B data in the HDFS directory  
> /user/`whoami`/problem9/solution/  
> Replace `whoami` with your OS user name**

### End of Problem

Since I don't have the file, I used weather.cvs

## Solution

### See File

```
$ hdfs dfs -cat /user/jsolis/data/weather.csv | head -5
wmain_temp_max,wsys_message,weather_id,wname,wdt,weather_icon,wvisibility,weather_main,temp_min,wsys_type,wmain_pressure,wcod,wind_speed,id,wclouds_all,coord_lon,weather_description,wsys_id,wsunset,wmain_temp,wbase,wind_deg,_version_,coord_lat,name,wsunrise,wmain_temp_min,wmain_humidity
304.15,0.005,800,Lenexa,1501718040,01d,16093,Clear,301.15,1,1017.0,200,2.1,6c367d2e-f278-42e3-a98d-076190141de0,1,-94.73,clear sky,1087,1501810061,302.16,stations,250.0,1574670382975156224,38.95,,1501759311,301.15,54.0
304.15,0.005,800,Lenexa,1501718040,01d,16093,Clear,301.15,1,1017.0,200,2.1,24f9e4dc-6161-4d20-b37b-d25072c0e07b,1,-94.73,clear sky,1087,1501810061,302.16,stations,250.0,1574670382981447680,38.95,,1501759311,301.15,54.0
304.15,0.005,800,Lenexa,1501718040,01d,16093,Clear,301.15,1,1017.0,200,2.1,1f9a0d5e-0318-4e99-bd51-2c69737718e7,1,-94.73,clear sky,1087,1501810061,302.16,stations,250.0,1574670382981447681,38.95,,1501759311,301.15,54.0
304.15,0.005,800,Lenexa,1501718040,01d,16093,Clear,301.15,1,1017.0,200,2.1,769382d7-9e5a-4a1d-99fd-abb511881d2b,1,-94.73,clear sky,1087,1501810061,302.16,stations,250.0,1574670382982496256,38.95,,1501759311,301.15,54.0
```

### Read file

```
val w = spark.read.
option("sep", ",").
option("header", "true").
format("csv").
load("/user/jsolis/data/weather.csv")

w.show
```

### Export File

```
w.write.
mode("overwrite").
format("csv").
option("compression", "snappy").
save("/user/jsolis/problem9/solution/")
```

To preserve headers use
`option("header", "true")`

### Check Results

```
spark.read.csv("/user/jsolis/problem9/solution/").show
+------+-----+---+------+----------+---+-----+-----+------+---+------+----+----+--------------------+----+------+---------+----+----------+------+--------+-----+-------------------+-----+----+----------+------+----+
|   _c0|  _c1|_c2|   _c3|       _c4|_c5|  _c6|  _c7|   _c8|_c9|  _c10|_c11|_c12|                _c13|_c14|  _c15|     _c16|_c17|      _c18|  _c19|    _c20| _c21|               _c22| _c23|_c24|      _c25|  _c26|_c27|
+------+-----+---+------+----------+---+-----+-----+------+---+------+----+----+--------------------+----+------+---------+----+----------+------+--------+-----+-------------------+-----+----+----------+------+----+
|304.15|0.005|800|Lenexa|1501718040|01d|16093|Clear|301.15|  1|1017.0| 200| 2.1|6c367d2e-f278-42e...|   1|-94.73|clear sky|1087|1501810061|302.16|stations|250.0|1574670382975156224|38.95|null|1501759311|301.15|54.0|
|304.15|0.005|800|Lenexa|1501718040|01d|16093|Clear|301.15|  1|1017.0| 200| 2.1|24f9e4dc-6161-4d2...|   1|-94.73|clear sky|1087|1501810061|302.16|stations|250.0|1574670382981447680|38.95|null|1501759311|301.15|54.0|
|304.15|0.005|800|Lenexa|1501718040|01d|16093|Clear|301.15|  1|1017.0| 200| 2.1|1f9a0d5e-0318-4e9...|   1|-94.73|clear sky|1087|1501810061|302.16|stations|250.0|1574670382981447681|38.95|null|1501759311|301.15|54.0|
|304.15|0.005|800|Lenexa|1501718040|01d|16093|Clear|301.15|  1|1017.0| 200| 2.1|769382d7-9e5a-4a1...|   1|-94.73|clear sky|1087|1501810061|302.16|stations|250.0|1574670382982496256|38.95|null|1501759311|301.15|54.0|
|304.15|0.005|800|Lenexa|1501718040|01d|16093|Clear|301.15|  1|1017.0| 200| 2.1|fa5a7059-6ab6-403...|   1|-94.73|clear sky|1087|1501810061|302.16|stations|250.0|1574670382982496257|38.95|null|1501759311|301.15|54.0|
|304.15|0.005|800|Lenexa|1501718040|01d|16093|Clear|301.15|  1|1017.0| 200| 2.1|1fe1a6ad-53dc-433...|   1|-94.73|clear sky|1087|1501810061|302.16|stations|250.0|1574670382982496258|38.95|null|1501759311|301.15|54.0|
|304.15|0.005|800|Lenexa|1501718040|01d|16093|Clear|301.15|  1|1017.0| 200| 2.1|567540eb-d357-42a...|   1|-94.73|clear sky|1087|1501810061|302.16|stations|250.0|1574670382982496259|38.95|null|1501759311|301.15|54.0|
|304.15|0.005|800|Lenexa|1501718040|01d|16093|Clear|301.15|  1|1017.0| 200| 2.1|de823ad0-9fe0-451...|   1|-94.73|clear sky|1087|1501810061|302.16|stations|250.0|1574670382982496260|38.95|null|1501759311|301.15|54.0|
|304.15|0.005|800|Lenexa|1501718040|01d|16093|Clear|301.15|  1|1017.0| 200| 2.1|34437490-a8dc-4f1...|   1|-94.73|clear sky|1087|1501810061|302.16|stations|250.0|1574670382982496261|38.95|null|1501759311|301.15|54.0|
|304.15|0.005|800|Lenexa|1501718040|01d|16093|Clear|301.15|  1|1017.0| 200| 2.1|1381829a-d31b-40c...|   1|-94.73|clear sky|1087|1501810061|302.16|stations|250.0|1574670382982496262|38.95|null|1501759311|301.15|54.0|
|304.15|0.005|800|Lenexa|1501718040|01d|16093|Clear|301.15|  1|1017.0| 200| 2.1|a551f8e3-ef8a-4a3...|   1|-94.73|clear sky|1087|1501810061|302.16|stations|250.0|1574670382982496263|38.95|null|1501759311|301.15|54.0|
|304.15|0.005|800|Lenexa|1501718040|01d|16093|Clear|301.15|  1|1017.0| 200| 2.1|dd16ce9f-b93f-489...|   1|-94.73|clear sky|1087|1501810061|302.16|stations|250.0|1574670382982496264|38.95|null|1501759311|301.15|54.0|
|304.15|0.005|800|Lenexa|1501718040|01d|16093|Clear|301.15|  1|1017.0| 200| 2.1|c603b654-871e-490...|   1|-94.73|clear sky|1087|1501810061|302.16|stations|250.0|1574670382982496265|38.95|null|1501759311|301.15|54.0|
|304.15|0.005|800|Lenexa|1501718040|01d|16093|Clear|301.15|  1|1017.0| 200| 2.1|455f7c37-dbe8-4b3...|   1|-94.73|clear sky|1087|1501810061|302.16|stations|250.0|1574670382982496266|38.95|null|1501759311|301.15|54.0|
|304.15|0.005|800|Lenexa|1501718040|01d|16093|Clear|301.15|  1|1017.0| 200| 2.1|388b8f5c-2545-415...|   1|-94.73|clear sky|1087|1501810061|302.16|stations|250.0|1574670382983544832|38.95|null|1501759311|301.15|54.0|
|304.15|0.005|800|Lenexa|1501718040|01d|16093|Clear|301.15|  1|1017.0| 200| 2.1|d37b3ebe-b53c-434...|   1|-94.73|clear sky|1087|1501810061|302.16|stations|250.0|1574670385200234496|38.95|null|1501759311|301.15|54.0|
|304.15|0.005|800|Lenexa|1501718040|01d|16093|Clear|301.15|  1|1017.0| 200| 2.1|4cae9ab8-4421-474...|   1|-94.73|clear sky|1087|1501810061|302.16|stations|250.0|1574670385204428800|38.95|null|1501759311|301.15|54.0|
|304.15|0.005|800|Lenexa|1501718040|01d|16093|Clear|301.15|  1|1017.0| 200| 2.1|695b25b5-e756-4b6...|   1|-94.73|clear sky|1087|1501810061|302.16|stations|250.0|1574670385204428801|38.95|null|1501759311|301.15|54.0|
|304.15|0.005|800|Lenexa|1501718040|01d|16093|Clear|301.15|  1|1017.0| 200| 2.1|13ba5382-9ab7-421...|   1|-94.73|clear sky|1087|1501810061|302.16|stations|250.0|1574670385204428802|38.95|null|1501759311|301.15|54.0|
|304.15|0.005|800|Lenexa|1501718040|01d|16093|Clear|301.15|  1|1017.0| 200| 2.1|4383d888-3dc7-496...|   1|-94.73|clear sky|1087|1501810061|302.16|stations|250.0|1574670385204428803|38.95|null|1501759311|301.15|54.0|
+------+-----+---+------+----------+---+-----+-----+------+---+------+----+----+--------------------+----+------+---------+----+----------+------+--------+-----+-------------------+-----+----+----------+------+----+
only showing top 20 rows
```

```
$ hdfs dfs -ls /user/jsolis/problem9/solution/
Found 3 items
-rw-r--r--   3 jsolis jsolis          0 2021-06-30 15:13 /user/jsolis/problem9/solution/_SUCCESS
-rw-r--r--   3 jsolis jsolis    2181524 2021-06-30 15:13 /user/jsolis/problem9/solution/part-00000-7ccabcba-8bb0-46c0-bff1-eee95aa2aa34-c000.csv.snappy
-rw-r--r--   3 jsolis jsolis    1080972 2021-06-30 15:13 /user/jsolis/problem9/solution/part-00001-7ccabcba-8bb0-46c0-bff1-eee95aa2aa34-c000.csv.snappy
```
